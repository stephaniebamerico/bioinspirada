WARNING:tensorflow:From nmt/utils/iterator_utils.py:235: group_by_window (from tensorflow.contrib.data.python.ops.grouping) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.experimental.group_by_window(...)`.
WARNING:tensorflow:From nmt/model_helper.py:402: __init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is deprecated, please use tf.nn.rnn_cell.LSTMCell, which supports all the feature this cell currently has. Please replace the existing code with tf.nn.rnn_cell.LSTMCell(name='basic_lstm_cell').
2019-11-29 06:26:42.340529: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.vi is already initialized.
2019-11-29 06:26:42.340593: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:26:42.340554: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:38:07.095524: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.vi is already initialized.
2019-11-29 06:38:07.095618: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:38:07.095624: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:38:07.247677: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.vi is already initialized.
2019-11-29 06:38:07.247696: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:38:07.247740: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:49:38.283733: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.vi is already initialized.
2019-11-29 06:49:38.283733: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:49:38.283742: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:49:38.433762: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:49:38.433762: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.vi is already initialized.
2019-11-29 06:49:38.433762: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:50:49.878767: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.vi is already initialized.
2019-11-29 06:50:49.878769: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:50:49.878791: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:50:50.041733: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.vi is already initialized.
2019-11-29 06:50:50.041737: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 06:50:50.041757: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 07:01:53.550134: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 07:01:53.550194: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.vi is already initialized.
2019-11-29 07:01:53.550176: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 07:01:53.716122: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.vi is already initialized.
2019-11-29 07:01:53.716126: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
2019-11-29 07:01:53.716127: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file tmp/iwslt15/vocab.en is already initialized.
), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_2/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_3/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_3/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/luong_attention/attention_g:0, (), /device:GPU:0
  dynamic_seq2seq/decoder/attention/attention_layer/kernel:0, (512, 256), /device:GPU:0
  dynamic_seq2seq/decoder/output_projection/kernel:0, (256, 17191), /device:GPU:0
# Creating eval graph ...
# Build a basic encoder
  num_layers = 4, num_residual_layers=0
  cell 0  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 1  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 2  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 3  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 0  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 1  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 2  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 3  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
# Trainable variables
Format: <name>, <shape>, <(soft) device placement>
  embeddings/encoder/embedding_encoder:0, (7709, 256), /device:GPU:0
  embeddings/decoder/embedding_decoder:0, (17191, 256), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_0/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_0/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_1/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_1/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_2/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_2/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_3/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_3/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/decoder/memory_layer/kernel:0, (256, 256), 
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_0/basic_lstm_cell/kernel:0, (768, 1024), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_0/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_1/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_1/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_2/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_2/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_3/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_3/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/luong_attention/attention_g:0, (), /device:GPU:0
  dynamic_seq2seq/decoder/attention/attention_layer/kernel:0, (512, 256), /device:GPU:0
  dynamic_seq2seq/decoder/output_projection/kernel:0, (256, 17191), /device:GPU:0
# Creating infer graph ...
# Build a basic encoder
  num_layers = 4, num_residual_layers=0
  cell 0  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 1  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 2  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 3  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 0  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 1  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 2  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  cell 3  LSTM, forget_bias=1  DeviceWrapper, device=/gpu:0
  decoder: infer_mode=greedybeam_width=0, length_penalty=0.000000, coverage_penalty=0.000000
# Trainable variables
Format: <name>, <shape>, <(soft) device placement>
  embeddings/encoder/embedding_encoder:0, (7709, 256), /device:GPU:0
  embeddings/decoder/embedding_decoder:0, (17191, 256), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_0/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_0/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_1/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_1/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_2/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_2/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_3/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_3/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/decoder/memory_layer/kernel:0, (256, 256), 
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_0/basic_lstm_cell/kernel:0, (768, 1024), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_0/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_1/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_1/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_2/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_2/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_3/basic_lstm_cell/kernel:0, (512, 1024), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_3/basic_lstm_cell/bias:0, (1024,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/luong_attention/attention_g:0, (), /device:GPU:0
  dynamic_seq2seq/decoder/attention/attention_layer/kernel:0, (512, 256), /device:GPU:0
  dynamic_seq2seq/decoder/output_projection/kernel:0, (256, 17191), 
# log_file=tmp/nmt_attention_model_VI_s20000_l4_u256/log_1575019585
  created train model with fresh parameters, time 0.25s
  created infer model with fresh parameters, time 0.12s
  # 185
    src: Tôi muốn thú nhận với các bạn một điều
    ref: And I &apos;m going to admit something to you .
    nmt: seven-year-old forearm Nine decades decades decades profession 1.5 presidents presidents presidents presidents rectangle rectangle rectangle rectangle rectangle rectangle
  created eval model with fresh parameters, time 0.13s
  eval dev: perplexity 17201.06, time 7s, Fri Nov 29 06:26:35 2019.
  eval test: perplexity 17208.07, time 6s, Fri Nov 29 06:26:42 2019.
  created infer model with fresh parameters, time 0.13s
# Start step 0, lr 1, Fri Nov 29 06:26:42 2019
# Init train iterator, skipping 0 elements
  step 100 lr 1 step-time 0.73s wps 3.80K ppl 51114.18 gN 107.67 bleu 0.00, Fri Nov 29 06:27:55 2019
  step 200 lr 1 step-time 0.68s wps 4.10K ppl 14335.47 gN 49.89 bleu 0.00, Fri Nov 29 06:29:03 2019
  step 300 lr 1 step-time 0.67s wps 4.11K ppl 9734.24 gN 53.17 bleu 0.00, Fri Nov 29 06:30:10 2019
  step 400 lr 1 step-time 0.68s wps 4.09K ppl 11880.40 gN 49.86 bleu 0.00, Fri Nov 29 06:31:19 2019
  step 500 lr 1 step-time 0.69s wps 4.08K ppl 10399.58 gN 48.44 bleu 0.00, Fri Nov 29 06:32:27 2019
  step 600 lr 1 step-time 0.67s wps 4.11K ppl 4837.13 gN 41.63 bleu 0.00, Fri Nov 29 06:33:34 2019
  step 700 lr 1 step-time 0.69s wps 4.14K ppl 2229.78 gN 34.83 bleu 0.00, Fri Nov 29 06:34:43 2019
  step 800 lr 1 step-time 0.68s wps 4.12K ppl 2520.03 gN 36.54 bleu 0.00, Fri Nov 29 06:35:51 2019
  step 900 lr 1 step-time 0.68s wps 4.19K ppl 932.02 gN 21.99 bleu 0.00, Fri Nov 29 06:37:00 2019
  step 1000 lr 1 step-time 0.66s wps 4.12K ppl 635.47 gN 14.09 bleu 0.00, Fri Nov 29 06:38:06 2019
# Save eval, global step 1000
  loaded infer model parameters from tmp/nmt_attention_model_VI_s20000_l4_u256/translate.ckpt-1000, time 0.14s
  # 578
    src: Tất cả đều là sự lựa chọn quan trọng
    ref: They &apos;re all important choices . &quot;
    nmt: So the , , ,
  loaded eval model parameters from tmp/nmt_attention_model_VI_s20000_l4_u256/translate.ckpt-1000, time 0.11s
  eval dev: perplexity 409.28, time 7s, Fri Nov 29 06:38:14 2019.
  eval test: perplexity 435.36, time 7s, Fri Nov 29 06:38:22 2019.
  step 1100 lr 1 step-time 0.68s wps 4.14K ppl 491.91 gN 6.22 bleu 0.00, Fri Nov 29 06:39:30 2019
  step 1200 lr 1 step-time 0.68s wps 4.14K ppl 456.79 gN 6.87 bleu 0.00, Fri Nov 29 06:40:38 2019
  step 1300 lr 1 step-time 0.68s wps 4.17K ppl 408.40 gN 32.78 bleu 0.00, Fri Nov 29 06:41:46 2019
  step 1400 lr 1 step-time 0.66s wps 4.24K ppl 361.66 gN 5.48 bleu 0.00, Fri Nov 29 06:42:52 2019
  step 1500 lr 1 step-time 0.67s wps 4.28K ppl 330.88 gN 4.69 bleu 0.00, Fri Nov 29 06:44:00 2019
  step 1600 lr 1 step-time 0.66s wps 4.24K ppl 301.87 gN 4.55 bleu 0.00, Fri Nov 29 06:45:05 2019
  step 1700 lr 1 step-time 0.67s wps 4.19K ppl 285.30 gN 4.54 bleu 0.00, Fri Nov 29 06:46:12 2019
  step 1800 lr 1 step-time 0.69s wps 4.14K ppl 261.80 gN 4.53 bleu 0.00, Fri Nov 29 06:47:21 2019
  step 1900 lr 1 step-time 0.69s wps 4.17K ppl 240.58 gN 4.61 bleu 0.00, Fri Nov 29 06:48:30 2019
  step 2000 lr 1 step-time 0.67s wps 4.14K ppl 213.25 gN 4.04 bleu 0.00, Fri Nov 29 06:49:37 2019
# Save eval, global step 2000
  loaded infer model parameters from tmp/nmt_attention_model_VI_s20000_l4_u256/translate.ckpt-2000, time 0.12s
  # 889
    src: À , Tosh.0 đã xem , và nhiều trang nhật ký trực tuyến bắt đầu viết về nó .
    ref: Well Tosh.0 picked it up , a lot of blogs starting writing about .
    nmt: This is a <unk> , the <unk> , the <unk> , the <unk> .
  loaded eval model parameters from tmp/nmt_attention_model_VI_s20000_l4_u256/translate.ckpt-2000, time 0.09s
  eval dev: perplexity 161.73, time 7s, Fri Nov 29 06:49:46 2019.
  eval test: perplexity 179.26, time 7s, Fri Nov 29 06:49:53 2019.
# Finished an epoch, step 2085. Perform external evaluation
  loaded infer model parameters from tmp/nmt_attention_model_VI_s20000_l4_u256/translate.ckpt-2000, time 0.10s
  # 423
    src: Một ngành ngư nghiệp quy mô lớn đang khai thác loại cá này cho đến thập niên 80 .
    ref: A big fishery was run on it until the &apos; 80s .
    nmt: This is a <unk> , the <unk> , the <unk> , the <unk> .
  loaded infer model parameters from tmp/nmt_attention_model_VI_s20000_l4_u256/translate.ckpt-2000, time 0.09s
# External evaluation, global step 2000
  decoding to output tmp/nmt_attention_model_VI_s20000_l4_u256/output_dev
  done, num sentences 1553, num translations per input 1, time 17s, Fri Nov 29 06:51:07 2019.
  bleu dev: 0.5
  saving hparams to tmp/nmt_attention_model_VI_s20000_l4_u256/hparams
# External evaluation, global step 2000
  decoding to output tmp/nmt_attention_model_VI_s20000_l4_u256/output_test
  done, num sentences 1268, num translations per input 1, time 16s, Fri Nov 29 06:51:24 2019.
  bleu test: 0.0
  saving hparams to tmp/nmt_attention_model_VI_s20000_l4_u256/hparams
  step 2100 lr 1 step-time 0.70s wps 3.87K ppl 205.72 gN 4.30 bleu 0.50, Fri Nov 29 06:51:38 2019
  step 2200 lr 1 step-time 0.68s wps 4.11K ppl 187.44 gN 3.84 bleu 0.50, Fri Nov 29 06:52:46 2019
  step 2300 lr 1 step-time 0.69s wps 4.10K ppl 181.82 gN 3.93 bleu 0.50, Fri Nov 29 06:53:54 2019
  step 2400 lr 1 step-time 0.68s wps 4.08K ppl 175.53 gN 3.86 bleu 0.50, Fri Nov 29 06:55:02 2019
  step 2500 lr 1 step-time 0.69s wps 4.09K ppl 166.41 gN 3.82 bleu 0.50, Fri Nov 29 06:56:11 2019
  step 2600 lr 1 step-time 0.69s wps 4.11K ppl 159.38 gN 3.92 bleu 0.50, Fri Nov 29 06:57:20 2019
  step 2700 lr 1 step-time 0.68s wps 4.10K ppl 153.50 gN 3.90 bleu 0.50, Fri Nov 29 06:58:28 2019
  step 2800 lr 1 step-time 0.68s wps 4.09K ppl 148.38 gN 3.89 bleu 0.50, Fri Nov 29 06:59:36 2019
  step 2900 lr 1 step-time 0.69s wps 4.05K ppl 145.23 gN 3.78 bleu 0.50, Fri Nov 29 07:00:45 2019
  step 3000 lr 1 step-time 0.67s wps 4.11K ppl 138.07 gN 3.74 bleu 0.50, Fri Nov 29 07:01:52 2019
# Save eval, global step 3000
  loaded infer model parameters from tmp/nmt_attention_model_VI_s20000_l4_u256/translate.ckpt-3000, time 0.12s
  # 1417
    src: Luôn có một sự bắt đầu với một phác thảo , một ý tưởng .
    ref: It always starts with a sketch , an idea .
    nmt: It &apos;s a very bit of the world .
  loaded eval model parameters from tmp/nmt_attention_model_VI_s20000_l4_u256/translate.ckpt-3000, time 0.10s
  eval dev: perplexity 117.01, time 7s, Fri Nov 29 07:02:01 2019.
  eval test: perplexity 135.15, time 7s, Fri Nov 29 07:02:08 2019.
  step 3100 lr 1 step-time 0.69s wps 4.12K ppl 136.29 gN 3.72 bleu 0.50, Fri Nov 29 07:03:17 2019
  step 3200 lr 1 step-time 0.68s wps 4.11K ppl 135.50 gN 3.90 bleu 0.50, Fri Nov 29 07:04:26 2019
  step 3300 lr 1 step-time 0.68s wps 4.13K ppl 131.93 gN 3.74 bleu 0.50, Fri Nov 29 07:05:34 2019
  step 3400 lr 1 step-time 0.69s wps 4.16K ppl 128.10 gN 3.70 bleu 0.50, Fri Nov 29 07:06:43 2019
  step 3500 lr 1 step-time 0.68s wps 4.12K ppl 124.56 gN 3.74 bleu 0.50, Fri Nov 29 07:07:51 2019
  step 3600 lr 1 step-time 0.68s wps 4.11K ppl 120.99 gN 3.66 bleu 0.50, Fri Nov 29 07:08:59 2019
  step 3700 lr 1 step-time 0.68s wps 4.13K ppl 120.10 gN 3.80 bleu 0.50, Fri Nov 29 07:10:07 2019
